% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/rwnn.R
\name{rwnn}
\alias{rwnn}
\alias{rwnn.formula}
\title{Random weight neural networks}
\usage{
rwnn(
  formula,
  data = NULL,
  n_hidden = c(),
  lambda = 0,
  type = NULL,
  control = list()
)

\method{rwnn}{formula}(
  formula,
  data = NULL,
  n_hidden = c(),
  lambda = 0,
  type = NULL,
  control = list()
)
}
\arguments{
\item{formula}{A \link{formula} specifying features and targets used to estimate the parameters of the output layer.}

\item{data}{A data-set (either a \link{data.frame} or a \link[tibble]{tibble}) used to estimate the parameters of the output layer.}

\item{n_hidden}{A vector of integers designating the number of neurons in each of the hidden layers (the length of the list is taken as the number of hidden layers).}

\item{lambda}{The penalisation constant used when training the output layer.}

\item{type}{A string indicating whether this is a regression or classification problem.}

\item{control}{A list of additional arguments passed to the \link{control_rwnn} function.}
}
\value{
An \link{RWNN-object}.
}
\description{
Set-up and estimate weights of a random weight neural network.
}
\details{
The deep RWNN is handled by increasing the number of elements in the \code{n_hidden} vector.
}
\examples{
## Models with a single hidden layer
n_hidden <- 50
lambda <- 1

y <- example_data[,1] |> as.matrix()
x <- example_data[,-1] |> as.matrix()
rwnn(y ~ x, n_hidden = n_hidden, lambda = lambda)


# Regression
m1 <- rwnn(y ~ ., data = example_data, n_hidden = n_hidden, lambda = lambda)

# Classification
m2 <- rwnn(I(y > median(y)) ~ ., data = example_data, n_hidden = n_hidden, lambda = lambda)

## Model with multiple hidden layers
n_hidden <- c(20, 15, 10, 5)
lambda <- 0.01

# Combining outputs from all hidden layers (default)
m3 <- rwnn(y ~ ., data = example_data, n_hidden = n_hidden, lambda = lambda)

# Using only the output of the last hidden layer
m4 <- rwnn(y ~ ., data = example_data, n_hidden = n_hidden,
           lambda = lambda, control = list(combine_hidden = FALSE))

}
